<app-header></app-header>

<div class="container">
  <h2 class="page-title">Signaler un Problème</h2>

  <div class="user-info" *ngIf="userInfo">
    <p><strong>Utilisateur:</strong> {{ userInfo.fullName }} ({{ userInfo.username }})</p>
  </div>

  <!-- Problem Submission Form -->
  <form (ngSubmit)="onSubmit()" #problemForm="ngForm" class="problem-form mb-5">
    <div class="form-group">
      <label for="problemType">Type de problème</label>
      <select
        id="problemType"
        name="problemType"
        [(ngModel)]="formData.problemType"
        required
        class="form-control"
      >
        <option value="" disabled selected>Sélectionner un type</option>
        <option value="Technique">Problème technique</option>
        <option value="Accès">Problème d’accès</option>
        <option value="Application">Application ne fonctionne pas</option>
        <option value="Autre">Autre</option>
      </select>
    </div>

    <div class="form-group">
      <label for="description">Description du problème</label>
      <textarea
        id="description"
        name="description"
        [(ngModel)]="formData.description"
        required
        placeholder="Décrivez le problème que vous rencontrez..."
        rows="5"
        class="form-control"
      ></textarea>
    </div>

    <button type="submit" [disabled]="!problemForm.form.valid" class="btn btn-primary mt-3">
      Envoyer
    </button>
  </form>

  <!-- Problem Reports Table -->
  <h3 class="mt-5">Tous les Problèmes Signalés</h3>
  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="thead-dark">
        <tr>
          <th>#</th>
          <th>Type de Problème</th>
          <th>Description</th>
          <th>Utilisateur</th>
          <th>Nom Complet</th>
          <th>Date de Soumission</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let report of problemReports; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ report.problemType }}</td>
          <td>{{ report.description }}</td>
          <td>{{ report.username }}</td>
          <td>{{ report.fullName }}</td>
          <td>{{ report.submittedAt | date: 'short' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<app-footer></app-footer>