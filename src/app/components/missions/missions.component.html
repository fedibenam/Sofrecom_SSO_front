
<div class="container py-5">
  
  <!-- Mission Status Dropdown -->
  <div class="row mb-5">
    <div class="col-md-6 mx-auto">
      <label for="missionStatus" class="form-label fw-bold mb-2">Select Mission Status:</label>
      <select
        id="missionStatus"
        class="form-select shadow-sm"
        [(ngModel)]="selectedStatus"
        (change)="onStatusChange()"
      >
        <option *ngFor="let status of ['CREE', 'VALIDEE', 'ARCHIVEE', 'ANNULEE', 'APPROUVEE']" [value]="status">
          {{ status }}
        </option>
      </select>
    </div>
  </div>

  <!-- Missions Section -->
  <section class="mb-5">
    <h2 class="section-title text-primary text-center mb-4">Missions ({{ selectedStatus }})</h2>
    <div class="card shadow-sm p-4 border-0 rounded">
      <div *ngIf="missions.length > 0; else noMissions">
        <div class="row g-3">
          <div class="col-md-6" *ngFor="let mission of missions | slice: 0:missionsLimit">
            <div class="list-group-item p-3 border rounded shadow-sm">
              <h5 class="fw-bold">Mission ID: {{ mission.id }}</h5>
              <p><strong>Designation:</strong> {{ mission.designation }}</p>
              <p><strong>Type:</strong> {{ mission.type }}</p>
              <p><strong>Status:</strong> {{ mission.etat }}</p>
              <p><strong>Start Date:</strong> {{ mission.dateDebutMission }}</p>
              <p><strong>End Date:</strong> {{ mission.dateFinMission }}</p>
              <p><strong>Total Tickets:</strong> {{ mission.totalBillet }}</p>
              <p><strong>Liquidation:</strong> {{ mission.statusLiquidation }}</p>
            </div>
          </div>
        </div>
      </div>
      <ng-template #noMissions>
        <p class="text-center text-muted">No missions found for the selected status.</p>
      </ng-template>
      <div class="text-center mt-3" *ngIf="missions.length > missionsLimit">
        <button class="btn btn-primary shadow-sm" (click)="loadMoreMissions()">Load More</button>
      </div>
    </div>
  </section>

  <!-- Past Missions Section -->
  <section class="mb-5">
    <h2 class="section-title text-success text-center mb-4">Past Missions</h2>
    <div class="card shadow-sm p-4 border-0 rounded">
      <div *ngIf="pastMissions.length > 0; else noPastMissions">
        <div class="row g-3">
          <div class="col-md-6" *ngFor="let mission of pastMissions | slice: 0:pastMissionsLimit">
            <div class="list-group-item p-3 border rounded shadow-sm">
              <h5 class="fw-bold">Mission ID: {{ mission.id }}</h5>
              <p><strong>Designation:</strong> {{ mission.designation }}</p>
              <p><strong>Type:</strong> {{ mission.type }}</p>
              <p><strong>Status:</strong> {{ mission.etat }}</p>
              <p><strong>Start Date:</strong> {{ mission.dateDebutMission }}</p>
              <p><strong>End Date:</strong> {{ mission.dateFinMission }}</p>
              <p><strong>Total Tickets:</strong> {{ mission.totalBillet }}</p>
              <p><strong>Liquidation:</strong> {{ mission.statusLiquidation }}</p>
            </div>
          </div>
        </div>
      </div>
      <ng-template #noPastMissions>
        <p class="text-center text-muted">No past missions found.</p>
      </ng-template>
      <div class="text-center mt-3" *ngIf="pastMissions.length > pastMissionsLimit">
        <button class="btn btn-success shadow-sm" (click)="loadMorePastMissions()">Load More</button>
      </div>
    </div>
  </section>

  <!-- Employees Section -->
  <section class="mb-5">
    <h2 class="section-title text-info text-center mb-4">
      Employees Managed by {{ employees[0]?.nomManager || 'Manager' }}
    </h2>
    <div class="card shadow-sm p-4 border-0 rounded">
      <div *ngIf="employees.length > 0; else noEmployees">
        <div class="row g-3">
          <div class="col-md-6" *ngFor="let employee of employees | slice: 0:employeesLimit">
            <div class="list-group-item p-3 border rounded shadow-sm">
              <h5 class="fw-bold">Name: {{ employee.nom }} {{ employee.prenom }}</h5>
              <p><strong>Matricule:</strong> {{ employee.matricule }}</p>
              <p><strong>Direction Code:</strong> {{ employee.code_direction }}</p>
              <p><strong>Designation:</strong> {{ employee.designation }}</p>
              <p><strong>Type:</strong> {{ employee.type }}</p>
              <p><strong>Start Date:</strong> {{ employee.date_debut_mission }}</p>
              <p><strong>End Date:</strong> {{ employee.date_fin_mission }}</p>
            </div>
          </div>
        </div>
      </div>
      <ng-template #noEmployees>
        <p class="text-center text-muted">No employees found.</p>
      </ng-template>
      <div class="text-center mt-3" *ngIf="employees.length > employeesLimit">
        <button class="btn btn-info shadow-sm" (click)="loadMoreEmployees()">Load More</button>
      </div>
    </div>
  </section>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-danger text-center mt-4 shadow-sm rounded">
    {{ errorMessage }}
  </div>

</div>

